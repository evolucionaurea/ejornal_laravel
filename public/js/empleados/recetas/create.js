!function(e){var n={};function a(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=e,a.c=n,a.d=function(e,n,t){a.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,n){if(1&n&&(e=a(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(a.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)a.d(t,o,function(n){return e[n]}.bind(null,o));return t},a.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(n,"a",n),n},a.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},a.p="/",a(a.s=62)}({62:function(e,n,a){e.exports=a("tF4N")},tF4N:function(e,n){!function(e,n,a){"use strict";var t={financiadores:null,diagnosticos:null,medicamentos:{},practicas:null},o=0,i=!1;function r(e){try{return e?/^https?:\/\//i.test(e)?e:new URL(e,n.location.origin).toString():"/"}catch(n){return e}}function c(){var n=e("#recetaForm");return{financiadores:r(n.data("url-get-financiadores")),diagnosticos:r(n.data("url-get-diagnosticos")),medicamentos:r(n.data("url-get-medicamentos")),practicas:r(n.data("url-get-practicas"))}}function l(e,t){var i=Date.now();if(!(i-o<4e3)){if(o=i,!n.Swal){var r=a.createElement("script");return r.src="https://cdn.jsdelivr.net/npm/sweetalert2@11",r.onload=function(){Swal.fire({icon:"error",title:e||"Error",text:t||"Ocurrió un error."})},void a.head.appendChild(r)}Swal.fire({icon:"error",title:e||"Error",text:t||"Ocurrió un error."})}}function s(e){if(!e)return"";var n=/^(\d{4})-(\d{2})-(\d{2})$/.exec(String(e).trim());return n?n[3]+"/"+n[2]+"/"+n[1]:""}function d(e){if(!e)return"";var n=/^(\d{1,2})[\/-](\d{1,2})[\/-](\d{4})$/.exec(String(e).trim());if(!n)return"";var a=("0"+n[1]).slice(-2),t=("0"+n[2]).slice(-2),o=n[3];return"".concat(o,"-").concat(t,"-").concat(a)}function m(n){var a=e('input[name="paciente[nombre]"]'),t=e('input[name="paciente[apellido]"]'),o=e('input[name="paciente[nroDoc]"]'),i=e('input[name="paciente[email]"]'),r=e('input[name="paciente[telefono]"]'),c=e("#paciente_fecha_visual"),l=e('input[name="paciente[fechaNacimiento]"]');if(void 0!==n.nombre&&a.val(n.nombre||""),void 0!==n.apellido&&t.val(n.apellido||""),void 0!==n.dni&&o.val(String(n.dni||"")),void 0!==n.email&&i.val(n.email||""),void 0!==n.telefono&&r.val(n.telefono||""),void 0!==n.fechaNacimiento){var m=d(n.fechaNacimiento)||n.fechaNacimiento,p=s(m);l.val(m||""),c.val(p||"")}var u=e('input[name="domicilio[calle]"]'),f=e('input[name="domicilio[numero]"]'),v=e('input[name="domicilio[localidad]"]'),b=e('input[name="domicilio[cp]"]');void 0!==n.calle&&u.val(n.calle||""),void 0!==n.nro&&f.val(String(n.nro||"")),void 0!==n.localidad&&v.val(n.localidad||""),void 0!==n.cod_postal&&b.val(String(n.cod_postal||""))}function p(e){var n=e.next(".select2").find(".select2-selection--single");n.css({height:"31px","min-height":"31px","border-radius":".2rem","border-color":"#ced4da",padding:"2px 8px"}),n.find(".select2-selection__rendered").css({"line-height":"26px","font-size":".875rem"}),n.find(".select2-selection__arrow").css({height:"29px",right:"6px"})}function u(){return function(){if(!i){var e=a.createElement("style");e.id="miniSpinnerCss",e.type="text/css",e.appendChild(a.createTextNode("\n      @keyframes miniSpin { 100% { transform: rotate(360deg);} }\n      .mini-spinner-wrap{display:inline-block;margin-left:6px;vertical-align:middle;}\n      .mini-spinner{display:inline-block; width:16px; height:16px; transform-origin:50% 50%; animation: miniSpin .9s linear infinite;}\n      .mini-spinner circle{stroke-linecap:round;}\n    ")),a.head.appendChild(e),i=!0}}(),'<span class="mini-spinner-wrap"><svg class="mini-spinner" viewBox="0 0 50 50" aria-hidden="true" focusable="false"><defs><linearGradient id="gradAzul" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stop-color="#2196f3"/><stop offset="100%" stop-color="#81d4fa"/></linearGradient></defs><circle cx="25" cy="25" r="20" stroke="url(#gradAzul)" fill="none" stroke-width="5"/></svg></span>'}function f(e){var n=e.closest(".form-group").find("label").first();n.length&&!n.find(".mini-spinner-wrap").length&&n.append(u())}function v(e){e.closest(".form-group").find("label .mini-spinner-wrap").remove()}function b(n,o){var i=n.find(".sel-medicamento"),r=n.find(".regno"),s=n.find(".presentacion"),d=n.find(".nombre"),m=n.find(".droga"),u=n.find(".duplicado"),b=c();i.select2({width:"100%",placeholder:"Buscar medicamento…",allowClear:!0,minimumInputLength:2,ajax:{delay:250,transport:function(n,a,r){t.medicamentos[o]&&4!==t.medicamentos[o].readyState&&t.medicamentos[o].abort();var c,s,d,m,p,u=(c=e("#financiador").val(),s=e("#plan").val(),d=e('input[name="paciente[nroDoc]"]').val(),m=e('input[name="cobertura[credencial]"]').val(),p={},c&&(p.idFinanciador=c),s&&(p.planid=s),d&&(p.afiliadoDni=d),m&&(p.afiliadoCredencial=m),p),g=n.data||function(){return{}},h="function"==typeof g?g(n):{},y=e.param(Object.assign({},h,u)),x=e.extend(!0,{},n,{timeout:2e4,url:b.medicamentos+(-1===b.medicamentos.indexOf("?")?"?":"&")+y}),w=i;return f(w),t.medicamentos[o]=e.ajax(x).done(a).fail((function(e){(!e||"abort"!==e.statusText&&0!==e.readyState)&&(l("Medicamentos",e.responseJSON&&e.responseJSON.message||"No se pudo buscar medicamentos."),r(e))})).always((function(){return v(w)})),t.medicamentos[o]},data:function(e){return{q:e.term||"",page:e.page||1}},processResults:function(e){return{results:e.results||[],pagination:{more:e.pagination&&e.pagination.more}}},cache:!0},dropdownParent:e(a.body),templateResult:function(n){if(!n.id)return n.text;var a=n.raw||{},t=[];return a.tieneCobertura&&t.push("Cobertura"),a.psicofarmaco&&t.push("Psicofármaco"),a.estupefaciente&&t.push("Estupefaciente"),a.ventaControlada&&t.push("Venta controlada"),a.hiv&&t.push("HIV"),e("<span>"+n.text+(t.length?' <small class="text-muted">('+t.join(", ")+")</small>":"")+"</span>")}}),p(i),i.on("select2:select",(function(){var e=i.select2("data")[0],n=e&&e.raw?e.raw:{};r.val(n.regNo||""),s.val(n.presentacion||""),d.val(n.nombreProducto||""),m.val(n.nombreDroga||""),!0===n.requiereDuplicado&&u.prop("checked",!0)}))}function g(){var n=1,a=e("#medsWrapper"),t=e("#btnAddMed");function o(){var e=a.children(".med-row");e.find(".btn-del-med").prop("disabled",e.length<=1)}a.length&&t.length&&(t.on("click",(function(){var t,i=e('\n      <div class="med-row border rounded p-2 mb-3">\n        <div class="form-row">\n          <div class="form-group col-md-4 mb-2">\n            <label class="mb-1 text-muted small">Buscar medicamento</label>\n            <select class="form-control form-control-sm sel-medicamento" style="width:100%"></select>\n          </div>\n          <div class="form-group col-md-2 mb-2">\n            <label class="mb-1 text-muted small">Cantidad</label>\n            <input type="number" min="1" class="form-control form-control-sm" name="medicamentos['.concat(t=n,'][cantidad]" required>\n          </div>\n          <div class="form-group col-md-3 mb-2">\n            <label class="mb-1 text-muted small">Reg. Nº</label>\n            <input type="text" class="form-control form-control-sm regno" name="medicamentos[').concat(t,'][regNo]" placeholder="Ej: 20095">\n          </div>\n          <div class="form-group col-md-3 mb-2">\n            <label class="mb-1 text-muted small">Presentación</label>\n            <input type="text" class="form-control form-control-sm presentacion" name="medicamentos[').concat(t,'][presentacion]" placeholder="comp. blister x 10">\n          </div>\n        </div>\n        <div class="form-row">\n          <div class="form-group col-md-4 mb-2">\n            <label class="mb-1 text-muted small">Nombre</label>\n            <input type="text" class="form-control form-control-sm nombre" name="medicamentos[').concat(t,'][nombre]" placeholder="TAFIROL">\n          </div>\n          <div class="form-group col-md-4 mb-2">\n            <label class="mb-1 text-muted small">Droga</label>\n            <input type="text" class="form-control form-control-sm droga" name="medicamentos[').concat(t,'][nombreDroga]" placeholder="paracetamol">\n          </div>\n          <div class="form-group col-md-3 mb-2">\n            <label class="mb-1 text-muted small">Tratamiento (días)</label>\n            <input type="number" min="0" class="form-control form-control-sm" name="medicamentos[').concat(t,'][tratamiento]" placeholder="0">\n          </div>\n          <div class="form-group col-md-1 d-flex align-items-end mb-2">\n            <button type="button" class="btn btn-sm btn-outline-danger btn-del-med">×</button>\n          </div>\n        </div>\n        <div class="form-group mb-2">\n          <label class="mb-1 text-muted small">Posología</label>\n          <input type="text" class="form-control form-control-sm" name="medicamentos[').concat(t,'][posologia]" placeholder="1 comprimido cada 8 horas">\n        </div>\n        <div class="form-group mb-2">\n          <label class="mb-1 text-muted small">Indicaciones / Observaciones</label>\n          <textarea class="form-control form-control-sm" name="medicamentos[').concat(t,'][indicaciones]" rows="2" placeholder="No tomar con alcohol"></textarea>\n        </div>\n        <div class="custom-control custom-checkbox custom-control-inline">\n          <input type="checkbox" class="custom-control-input duplicado" id="dup').concat(t,'" name="medicamentos[').concat(t,'][forzarDuplicado]" value="1">\n          <label class="custom-control-label" for="dup').concat(t,'">Requiere duplicado</label>\n        </div>\n      </div>'));a.append(i),b(i,n),n++,o()})),a.on("click",".btn-del-med",(function(){var n=e(this).closest(".med-row");a.children().length>1&&(n.remove(),o())})),b(a.find(".med-row").first(),0),o())}function h(){var n=e("#practica_search"),o=e("#practicasList"),i=e("#practicasHidden");if(n.length){var r=c();n.select2({width:"100%",placeholder:"Buscar práctica…",allowClear:!0,minimumInputLength:2,ajax:{delay:300,transport:function(a,o,i){t.practicas&&4!==t.practicas.readyState&&t.practicas.abort();var c=e.extend(!0,{},a,{timeout:2e4,url:r.practicas}),s=n;return f(s),t.practicas=e.ajax(c).done(o).fail((function(e){(!e||"abort"!==e.statusText&&0!==e.readyState)&&(l("Prácticas",e.responseJSON&&e.responseJSON.message||"No se pudo buscar prácticas."),i(e))})).always((function(){return v(s)})),t.practicas},data:function(e){var n=e.term||"",a={page:e.page||1},t=n.match(/tipo:([^ ]+)/i),o=n.match(/cat:([^ ]+)/i);t&&(a.tipo=t[1]),o&&(a.categoria=o[1]);var i=n.replace(/tipo:[^ ]+/gi,"").replace(/cat:[^ ]+/gi,"").trim();return i&&(a.search=i),a},processResults:function(e){return{results:e.results||[],pagination:{more:e.pagination&&e.pagination.more}}},cache:!0},dropdownParent:e(a.body)}),p(n),n.on("select2:select",(function(){var a=n.select2("data")[0];a&&(!function(n){var a=n.id;if(!i.find('input[value="'+a+'"]').length){var t=e('<input type="hidden" name="practicas[]">').val(a);i.append(t);var r=e('<span class="badge badge-primary d-inline-flex align-items-center mr-2 mb-2" data-id="'+a+'" style="font-size:.8rem;"><span class="mr-2">'+n.text+'</span><button type="button" class="btn btn-sm btn-light py-0 px-1 quitar-chip" aria-label="Quitar" style="line-height:1;">×</button></span>');o.append(r)}}(a),n.val(null).trigger("change"))})),o.on("click",".quitar-chip",(function(){var n=e(this).closest("[data-id]"),a=n.data("id");i.find('input[name="practicas[]"][value="'+a+'"]').remove(),n.remove()}))}}e((function(){e.ajaxSetup({headers:{"X-CSRF-TOKEN":e('meta[name="csrf-token"]').attr("content")},timeout:2e4}),function(){var n=e('input[name="paciente[fechaNacimiento]"]');if(n.length){var a=s(n.val()),t=e('<input type="text" id="paciente_fecha_visual" class="form-control form-control-sm" placeholder="DD/MM/AAAA" readonly>');t.val(a),n.after(t).hide(),e.datepicker&&!e.datepicker.regional.es&&(e.datepicker.regional.es={closeText:"Cerrar",prevText:"Anterior",nextText:"Siguiente",currentText:"Hoy",monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],dayNames:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],dayNamesShort:["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"],dayNamesMin:["Do","Lu","Ma","Mi","Ju","Vi","Sa"],weekHeader:"Sm",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.es)),e.fn.datepicker&&t.datepicker({changeMonth:!0,changeYear:!0,yearRange:"1900:+0",dateFormat:"dd/mm/yy",onClose:function(e){var a=d(e);n.val(a)}}),t.on("focus click",(function(){e.fn.datepicker&&e(this).datepicker("show")}))}}(),e("#recetaForm").on("submit",(function(){var n=e("#paciente_fecha_visual"),a=e('input[name="paciente[fechaNacimiento]"]');n.length&&a.length&&a.val(d(n.val()))}));var n=0,o=setInterval((function(){n++,"function"==typeof e.fn.select2?(clearInterval(o),function(){var n=e("#id_nomina");if(n.length){var t=n.find("option").toArray();if(t.length>1){var o=t.shift();t.sort((function(n,a){return e(n).text().localeCompare(e(a).text(),"es",{sensitivity:"base"})})),n.empty().append(o).append(t)}n.select2({width:"100%",placeholder:"Seleccione…",allowClear:!0,minimumInputLength:0,dropdownParent:e(a.body)}),p(n),n.on("select2:select",i),n.on("change",i),n.val()&&i()}function i(){if(n.val()){var e=n.find("option:selected");if(e.length){var a=e.data("nombre");a||(a=(e.text()||"").trim().replace(/\s+—\s+.*$/,"").replace(/\(DNI:.*?\)/,"").trim());var t=function(e){if(!(e=(e||"").trim().replace(/\s+/g," ")))return{apellido:"",nombre:""};var n=e.indexOf(" ");return-1===n?{apellido:"",nombre:e}:{apellido:e.substring(0,n),nombre:e.substring(n+1)}}(a);m({nombre:t.nombre,apellido:t.apellido,dni:e.data("dni"),email:e.data("email"),telefono:e.data("telefono"),fechaNacimiento:e.data("fecha-nacimiento"),calle:e.data("calle"),nro:e.data("nro"),localidad:e.data("localidad"),cod_postal:e.data("cod-postal")})}}else m({nombre:"",apellido:"",dni:"",email:"",telefono:"",fechaNacimiento:"",calle:"",nro:"",localidad:"",cod_postal:""})}}(),function(){var n=e("#financiador"),o=e("#plan");if(n.length){var i=c(),r=[],s=function(n){var t=o.data("select2")&&o.data("select2").isOpen&&o.data("select2").isOpen(),i=o.val();if(o.data("select2"))try{o.select2("destroy")}catch(e){}n?o.prop("disabled",!0).attr("disabled","disabled"):o.prop("disabled",!1).removeAttr("disabled"),o.select2({width:"100%",placeholder:"Plan…",allowClear:!0,minimumInputLength:0,dropdownParent:e(a.body)}),p(o),!n&&i&&o.val(i).trigger("change"),!n&&t&&o.select2("open")};o.empty().append('<option value=""></option>'),s(!0),n.select2({width:"100%",placeholder:"Financiador…",allowClear:!0,minimumInputLength:1,ajax:{delay:250,transport:function(a,o,r){t.financiadores&&4!==t.financiadores.readyState&&t.financiadores.abort();var c=e.extend(!0,{},a,{timeout:2e4,url:i.financiadores}),s=n;return f(s),t.financiadores=e.ajax(c).done(o).fail((function(e){(!e||"abort"!==e.statusText&&0!==e.readyState)&&(l("Financiadores",e.responseJSON&&e.responseJSON.message||"No se pudo cargar el listado."),r(e))})).always((function(){return v(s)})),t.financiadores},processResults:function(e,n){r=e&&e.results?e.results:[];var a=(n&&n.term?String(n.term).toLowerCase():"").trim(),t=r;return a&&(t=r.filter((function(e){return-1!==String(e.text).toLowerCase().indexOf(a)}))),{results:t}},cache:!0},dropdownParent:e(a.body)}),p(n),n.on("select2:select",(function(){var e=n.select2("data")[0];o.empty().append('<option value=""></option>'),e&&e.raw&&Array.isArray(e.raw.planes)&&e.raw.planes.length?(e.raw.planes.forEach((function(e){return o.append('<option value="'+e.id+'">'+e.nombre+"</option>")})),s(!1),o.select2("open")):s(!0)})),n.on("select2:clear",(function(){o.empty().append('<option value=""></option>'),s(!0)}))}}(),function(){var n=e("#diag_search"),o=e("#diagnostico"),i=e("#diagnostico_codigo");if(n.length){var r=c();n.select2({width:"100%",placeholder:"Buscar diagnóstico…",allowClear:!0,minimumInputLength:3,ajax:{delay:300,transport:function(a,o,i){t.diagnosticos&&4!==t.diagnosticos.readyState&&t.diagnosticos.abort();var c=e.extend(!0,{},a,{timeout:2e4,url:r.diagnosticos}),s=n;return f(s),t.diagnosticos=e.ajax(c).done(o).fail((function(e){(!e||"abort"!==e.statusText&&0!==e.readyState)&&(l("Diagnósticos",e.responseJSON&&e.responseJSON.message||"No se pudo buscar diagnósticos."),i(e))})).always((function(){return v(s)})),t.diagnosticos},processResults:function(e){return e},cache:!0},dropdownParent:e(a.body)}),p(n),n.on("select2:select",(function(){var e=n.select2("data")[0];e&&(i.val(e.id||""),o.val(e.text||""))})),n.on("select2:clear",(function(){i.val("")}))}}(),g(),h()):n>60&&(clearInterval(o),g())}),100)}))}(jQuery,window,document)}});